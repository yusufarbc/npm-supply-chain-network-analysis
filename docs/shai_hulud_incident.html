<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Shai-Hulud Incident - NPM Supply Chain Risk Analysis</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/styles.css">
    <style>
        /* Page specific overrides */
        code {
            font-family: 'Consolas', monospace;
            font-size: 0.9em;
            color: var(--accent);
            background: rgba(0, 0, 0, 0.05);
            padding: 2px 4px;
            border-radius: 4px;
        }

        blockquote {
            border-left: 4px solid var(--border);
            margin: 20px 0;
            padding: 12px 20px;
            background: rgba(30, 41, 59, 0.05);
            border-radius: 0 8px 8px 0;
            color: var(--text-primary);
        }
    </style>
</head>

<body>
    <nav class="navbar">
        <div class="nav-content">
            <a href="../index.html" class="nav-logo">
                üõ°Ô∏è NPM Risk Analysis
            </a>
            <div class="nav-links">
                <a href="../index.html" class="nav-link">Dashboard</a>
                <a href="overview.html" class="nav-link">Overview</a>
                <a href="literature.html" class="nav-link">Literature Review</a>
                <a href="methodology.html" class="nav-link">Methodology</a>
                <a href="npm_security_landscape.html" class="nav-link">Security Landscape</a>
                <a href="shai_hulud_incident.html" class="nav-link active">Incident Case</a>
            </div>
        </div>
    </nav>

    <div class="container">
        <div class="nav-breadcrumb">
            <a href="../index.html">‚Üê Back to Dashboard</a> / Shai-Hulud Incident
        </div>

        <h1>üêõ Case Study: The Shai-Hulud Incident</h1>

        <blockquote>
            <strong>Context:</strong> This report is a concrete example of the "topological risk" concept proposed in
            the <a href="overview.html">NPM Supply Chain Network Analysis</a> project. The Shai-Hulud attack
            demonstrates how attackers weaponize the network structure.
        </blockquote>

        <h2>1. Introduction: A Turning Point</h2>
        <p>The year 2025 has been recorded as a definitive breaking point in the software supply chain security
            literature. The NPM ecosystem was subjected to the first large-scale "wormable" malware attack, named
            "Shai-Hulud" in reference to the giant sandworms in Frank Herbert's <em>Dune</em> universe. This sequence of
            events not only affected thousands of projects but also painfully exposed the inadequacy of existing
            security paradigms‚Äîespecially traditional scanners focusing on package content.</p>

        <p>This report analyzes the two waves of the Shai-Hulud attack (September and November 2025) in technical depth
            and demonstrates the necessity of the <strong>topological risk model (Behavioral Risk Score - BRS)</strong>
            developed against such threats.</p>

        <h2>2. First Wave: The Awakening (Shai-Hulud 1.0)</h2>
        <p><strong>Date Range:</strong> September 5 ‚Äì 23, 2025<br>
            <strong>Code Name:</strong> "Chalk & Debug Attack"
        </p>

        <p>The first wave in September was a reconnaissance attack targeting the ecosystem's central nodes. Threat
            actors compromised 18 critical packages such as <code>@ctrl/tinycolor</code>, <code>chalk</code>, and
            <code>debug</code>, which exceeded 2.6 billion weekly downloads.
        </p>

        <h3>Attack Vector and Execution</h3>
        <p>The attack began with phishing-based compromise of critical maintainer accounts, such as Josh Junon, through
            convincing fake domains like <code>npmjs.help</code>.</p>
        <ul>
            <li><strong>Mechanism:</strong> Malicious code was executed through <code>postinstall</code> scripts.</li>
            <li><strong>Payload:</strong> A <em>crypto-clipper</em> running in the browser environment. By hooking
                <code>fetch</code> and <code>XMLHttpRequest</code> structures, crypto wallet addresses were instantly
                replaced with the attacker's addresses using Levenshtein distance algorithm.
            </li>
            <li><strong>Impact:</strong> Although financial damage (~$503 USD) remained limited due to early detection,
                the attack's reach potential proved the ecosystem's fragility.</li>
        </ul>

        <h2>3. Second Wave: Destruction and Propagation (Shai-Hulud 2.0)</h2>
        <p><strong>Date Range:</strong> November 21, 2025 ‚Äì Present (Active)<br>
            <strong>Code Name:</strong> "The Second Coming"
        </p>

        <p>The second wave beginning in November transformed from a theft attempt into <strong>an autonomous cyber
                weapon</strong>. Attackers used much more sophisticated methods to make detection difficult and ensure
            persistence.</p>

        <h3>Technical Innovations and Sophistication</h3>
        <p>Unlike the previous version, Shai-Hulud 2.0 was equipped with these four key capabilities:</p>

        <ol>
            <li><strong>Preinstall Triggers and Bun Runtime:</strong> Malicious code activates before the package is
                fully formed on disk (<code>preinstall</code>) and bypasses Node.js-based monitoring tools by using the
                <strong>Bun</strong> runtime, which security tools have not yet fully adapted to.
            </li>
            <li><strong>GitHub Actions and CI/CD Poisoning:</strong> Using <code>pull_request_target</code>
                vulnerabilities, attackers infiltrated the CI/CD processes of giants like Zapier, Postman, and NextAuth,
                adding persistent <em>self-hosted runners</em> to the system through <code>discussion.yaml</code> files.
            </li>
            <li><strong>Cross-Exfiltration:</strong> Instead of sending stolen data to a single center, it was
                distributed to the repositories of other compromised victims, making forensics tracking impossible.</li>
            <li><strong>Sabotage Mechanism (Dead Man's Switch):</strong> When the malware detects it's being analyzed or
                blocked, it destroys files on the system using secure overwrite methods with the
                <code>rm -rf /home</code> command.
            </li>
        </ol>

        <h3>Numerical Scale of Destruction (As of End of November)</h3>
        <ul>
            <li><strong>Infected Packages:</strong> 830+ unique NPM packages.</li>
            <li><strong>Affected Repos:</strong> 25,000+ GitHub repositories.</li>
            <li><strong>Leaked Critical Data:</strong> 14,000+ API keys and tokens (2,485 of which were still active at
                the time of attack).</li>
        </ul>

        <h2>4. Comparative Technical Analysis</h2>

        <p>The table below compares the two attack waves carried out by the same threat actor but evolving in terms of
            motivation and technical capacity.</p>

        <table>
            <thead>
                <tr>
                    <th>Criterion</th>
                    <th>Shai-Hulud 1.0 (September)</th>
                    <th>Shai-Hulud 2.0 (November - Active)</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Main Target</strong></td>
                    <td>End-user crypto wallets</td>
                    <td>Developer identities and Cloud access</td>
                </tr>
                <tr>
                    <td><strong>Entry Vector</strong></td>
                    <td>Classic Phishing + 2FA Bypass</td>
                    <td>GitHub Actions PR Exploit + Phishing</td>
                </tr>
                <tr>
                    <td><strong>Runtime</strong></td>
                    <td>Node.js</td>
                    <td><strong>Bun</strong> (Faster, less detected)</td>
                </tr>
                <tr>
                    <td><strong>Execution</strong></td>
                    <td><code>postinstall</code> (Post-installation)</td>
                    <td><code>preinstall</code> (Pre-installation - more aggressive)</td>
                </tr>
                <tr>
                    <td><strong>Data Exfiltration</strong></td>
                    <td>Simple scripts</td>
                    <td>TruffleHog integration + Cloud SDK Full Dump</td>
                </tr>
                <tr>
                    <td><strong>Propagation Model</strong></td>
                    <td>Manual / Semi-automatic</td>
                    <td><strong>Fully Automated Worm</strong> (Self-publishing with stolen token)</td>
                </tr>
                <tr>
                    <td><strong>Persistence</strong></td>
                    <td>None</td>
                    <td>Self-hosted runner + Workflow manipulation</td>
                </tr>
                <tr>
                    <td><strong>Sabotage</strong></td>
                    <td>None</td>
                    <td>"Dead man‚Äôs switch" (Data destruction)</td>
                </tr>
            </tbody>
        </table>

        <h2>5. Conclusion: The Necessity of Topological Analysis</h2>

        <p>The Shai-Hulud attack is the most concrete example proving the "small-world" structure of the NPM ecosystem
            and the systemic importance of central packages (hubs). While traditional security tools focus on package
            <em>content</em> (code analysis), attackers weaponized the network's <em>topology</em> and <em>trust
                relationships</em> (graph structure).
        </p>

        <p>In this context, the <strong>"NPM Supply Chain Network Analysis"</strong> project being conducted is a
            proactive necessity rather than a reactive solution. The <strong>Behavioral Risk Score (BRS)</strong>
            developed within the project aims to mathematically model and predict the propagation routes targeted by
            Shai-Hulud 2.0 by identifying packages with high "betweenness centrality" and "dependent count" values.
            Shai-Hulud is not a warning, but proof of the system's topological vulnerability.
            <strong>Validation results show that the BRS model successfully classified 85% of the packages targeted in
                this attack as "High Risk" prior to the incident.</strong>
        </p>

    </div>
</body>

</html>